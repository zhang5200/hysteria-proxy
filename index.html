<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hysteria 管理面板</title>
    <link rel="stylesheet" href="/static/css/styles.css">
</head>

<body>

    <!-- Login Overlay -->
    <div id="login-overlay">
        <div class="login-card">
            <svg class="login-logo" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                style="color: var(--primary);">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
            </svg>
            <div class="login-title">Hysteria 面板</div>
            <div class="input-group">
                <input type="password" id="loginPassword" placeholder="请输入访问密码..."
                    onkeyup="if(event.key === 'Enter') checkLogin()">
            </div>
            <button class="btn btn-primary" style="width: 100%; justify-content: center; padding: 12px;"
                onclick="checkLogin()">
                登录验证
            </button>
            <p id="loginError" style="color: var(--danger); margin-top: 10px; display: none; font-size: 14px;">密码错误，请重试
            </p>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container" id="mainApp" style="opacity: 0; transition: opacity 0.5s;">
        <div class="header">
            <div class="brand">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
                Hysteria 面板
            </div>
            <div>
                <button class="btn btn-danger" onclick="logout()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                    </svg>
                    退出登录
                </button>
            </div>
        </div>

        <div class="card">
            <div class="layout-container">
                <!-- Left Sidebar Menu -->
                <div class="sidebar-menu">
                    <button class="menu-item active" onclick="switchTab('users')">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                        </svg>
                        用户管理
                    </button>
                    <button class="menu-item" onclick="switchTab('nodes')">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                        </svg>
                        节点管理
                    </button>
                    <button class="menu-item" onclick="switchTab('subscription')">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z" />
                        </svg>
                        VPN订阅
                    </button>
                </div>

                <!-- Right Content Area -->
                <div class="content-area">
                    <!-- Users Tab -->
                    <div id="usersTab" class="tab-content active">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="margin: 0; font-size: 18px;">用户列表</h3>
                    <button class="btn btn-primary" onclick="showAddUserModal()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
                        </svg>
                        添加用户
                    </button>
                </div>

                <div class="data-grid" id="userTable">
                    <!-- Cards injected here -->
                </div>
            </div>

            <!-- Nodes Tab -->
            <div id="nodesTab" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="margin: 0; font-size: 18px;">节点列表</h3>
                    <button class="btn btn-primary display flex" onclick="showAddNodeModal()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
                        </svg>
                        添加节点
                    </button>
                </div>

                <div class="data-grid" id="nodeTable">
                    <!-- Cards injected here -->
                </div>
            </div>

            <!-- Subscription Tab -->
            <div id="subscriptionTab" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="margin: 0; font-size: 18px;">VPN订阅管理</h3>
                </div>

                <div class="data-grid" id="subscriptionTable">
                    <!-- Subscription cards injected here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="userModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="userModalTitle">添加用户</h3>
                <span class="close-btn" onclick="closeUserModal()">&times;</span>
            </div>
            <div class="form-group">
                <label>用户名</label>
                <input type="text" id="usernameInput" placeholder="请输入用户名">
            </div>
            <div class="form-group">
                <label>密码</label>
                <input type="text" id="passwordInput" placeholder="请输入密码">
            </div>
            <div class="form-group">
                <label>流量限制</label>
                <input type="number" id="trafficLimitInput" placeholder="GB (0=无限制)" min="0" step="1" value="0">
            </div>
            <div class="form-group">
                <label style="width: auto; margin-right: 0;">
                    <input type="checkbox" id="autoDisableInput" checked style="width: auto; margin-right: 8px;"> 超限自动停用
                </label>
            </div>
            <div style="text-align: right; margin-top: 24px;">
                <button class="btn btn-danger" onclick="closeUserModal()" style="margin-right: 8px;">取消</button>
                <button class="btn btn-primary" onclick="saveUser()">保存用户</button>
            </div>
        </div>
    </div>

    <div id="nodeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="nodeModalTitle">添加节点</h3>
                <span class="close-btn" onclick="closeNodeModal()">&times;</span>
            </div>
            <div class="form-group">
                <label>节点名称</label>
                <input type="text" id="nodeNameInput" placeholder="例如: HongKong-01">
            </div>
            <div class="form-group">
                <label>节点地址</label>
                <input type="text" id="nodeHostInput" placeholder="例如: 192.168.1.1:8080">
            </div>
            <div class="form-group">
                <label>访问密钥</label>
                <input type="text" id="nodeSecretInput" placeholder="节点通信密钥">
            </div>
            <div style="text-align: right; margin-top: 24px;">
                <button class="btn btn-danger" onclick="closeNodeModal()" style="margin-right: 8px;">取消</button>
                <button class="btn btn-primary" onclick="saveNode()">保存节点</button>
            </div>
        </div>
    </div>


    <!-- QR Code Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js "></script>

    <!-- Application Scripts -->
    <script src="/static/js/app.js"></script>
    <script src="/static/js/subscription.js"></script>

</body>

</html>